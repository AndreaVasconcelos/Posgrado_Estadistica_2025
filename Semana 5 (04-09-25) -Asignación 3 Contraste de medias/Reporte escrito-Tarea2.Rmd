---
output:
  pdf_document: default
  html_document: default
---
---
title: Comparación de longitud de pétalo de la base de datos Iris tomando en cuenta
  versicolor y virginica.
author: "Andrea Luna Vasconcelos"
date: "2025-09-05"
output: html_document


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
library(ggplot2)

# Planteamiento del problema e hipótesis

# En este caso se analiza la longitud de pétalo entre las especies versicolor y virginica.
# H0 = No existe diferencia significativa en la longitud de pétalos entre versicolor y virginica.
# H1 = Sí existe una diferencia significativa en la longitud de pétalos entre versicolor y virginica.
```
```{r}
# Base de datos

data("iris")
dat_iris <- subset(iris, Species %in% c("versicolor", "virginica"))
dat_iris$Species <- droplevels(dat_iris$Species)
versicolor <- subset(dat_iris, Species == "versicolor")$Petal.Length
virginica  <- subset(dat_iris, Species == "virginica")$Petal.Length
dat_sub <- dat_iris
```{r}
# Comprobación de supuestos y prueba t de Student

# QQ-plot -----------------------------------------------------------------
par(mfrow=c(1,2))
qqnorm(versicolor); qqline(versicolor)
qqnorm(virginica); qqline(virginica)
par(mfrow=c(1,2))

# Normalidad --------------------------------------------------------------
# Normalidad 
shapiro.test(versicolor) # p-value = 0.1585
shapiro.test(virginica) #  p-value = 0.1098

# Varianza ----------------------------------------------------------------
# Varianza 
var.test(versicolor, virginica) # df = 49, p-value = 0.2637

# Homogeneidad ------------------------------------------------------------
# Homogeneidad 
var.test(versicolor, virginica, alternative = "two.sided")

# Nuestros datos de longitud de pétalo son normales según la prueba de Shapiro-Wilk (versicolor: p = 0.1585; virginica: p = 0.1098) y presentan varianzas homogéneas (F = 0.725, p = 0.2637). Por lo tanto, se puede aplicar la prueba t de Student con varianzas iguales y de dos colas para muestras independientes para comparar las medias de ambas especies.

# Prueba t de Student -----------------------------------------------------
# Prueba t de Student
t.test(versicolor, virginica,
       alternative = "two.sided",
       var.equal = T)

# p-value < 2.2e-16 = 0.00000000000000022 

# Resultados

# Los resultados de la prueba t indican t = -12.604, con df = 98 y p-value < 2.2×10⁻¹⁶, por lo que se rechaza H₀ y se acepta H₁. Las medias fueron: versicolor = 4.260 y virginica = 5.552, con un intervalo de confianza de 95% de [-1.495, -1.089].

# t = H0 rechazada, H1 aceptada
# df = 98
# p-value < 2.2e-16
# mean = versicolor:4.260 y virginica:5.552
# IC95%

```
```{r}
# Tamaño del efecto
cohens_efecto <- function(x, y) {
  n1 <- length(x); n2 <- length(y)
  s1 <- sd(x); s2 <- sd(y)
  sp <- sqrt(((n1 - 1) * s1^2 + (n2 - 1) * s2^2) / (n1 + n2 - 2))
  (mean(x) - mean(y)) / sp
}
d1_cal <- cohens_efecto(versicolor, virginica)
d1_cal

# Cohen’s d = r round(d1_cal,2) = efecto muy grande.
```
```{r}
# Visualización
ggplot(dat_sub, aes(x = Species, y = Petal.Length, fill = Species)) +
  geom_violin(trim = FALSE, color = "black", alpha = 0.6) + 
  geom_boxplot(width = 0.1, fill = "white", outlier.shape = NA) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "red") +
  theme_minimal() +
  labs(title = "Distribución de la longitud de pétalos por especie",
       x = "Especie",
       y = "Longitud de pétalo (cm)") +
  theme(legend.position = "none")
```{r}
# Interpretación biológica

# Virginia presenta pétalos significativamente más largos en comparación con versicolor con un Efecto de Cohen´s de 2.5207 lo que indica que es muy grande, esto puede estar asociado biológicamente a estrategias de adaptación, específicamente en la polinización al buscar atraer a más polinizadores para lograr su reproducción. Cuando el pétalo es más grande, tiene más absorción de luz ultravioleta lo que aumenta su visibilidad.
```


